---
description: Rules for generating Design System primitive React components
globs: **/*.tsx
alwaysApply: true
---

# React Component Patterns

Components in src/components/ui are Design System primitives and comes with Storybook stories.

- Reference @react.mdc (`.cursor/react.mdc`) for general react code style and practices
- Reference @typescript.mdc (`.cursor/typescript.mdc`) for general typescript code style and practices
- Use @component.template.tsx (`src/components/ui/.cursor/templates/component.template.tsx`) code style and practices

- If a component requires interactivity, use `radix-ui` primitves and ensure that the component is accessible
- If a component requires interactivity mark it explicitly with 'use client'

## Component Structure & Organization

### File Organization

- Component file: `src/components/ui/component-name/component-name.tsx`
- Stories file: `src/components/ui/component-name/component-name.stories.tsx`

### Import Style

```typescript
import type { ComponentPropsWithoutRef } from "react";
import { Slot } from "radix-ui";
import { cva, type VariantProps } from "class-variance-authority";
import { cn } from "@/styles/utils";
```

### Import Order

1. React types and methods (`ComponentPropsWithoutRef`, `useEffect`, etc.)
2. Third-party libraries (`radix-ui`, `class-variance-authority`)
3. Internal utilities (`@/lib/utils`)
4. Internal components (`@/components/ui/...`)

## Utility Classes

- Use `cn()` utility for conditional classes
- Use `cva()` utility to define variants for a component

## Component structure

Use the `<Slot/>` component from `radix-ui` and a `asChild` prop to to allow component consumers to map props to their own components. Any prop that starts with on (e.g., onClick) is considered an event handler.
When merging event handlers, Slot will create a new function where the child handler takes precedence over the slot handler.
If one of the event handlers relies on event.defaultPrevented make sure that the order is correct.

## Figma MCP

- Use the Figma MCP /get_code to derive the props of a component
- Use the Figma MCP /get_variable_defs to derive the design tokens to use
    - Reference @theme.css (`src/styles/theme`) to see which tokens are available
    - Never use values of Figma variables, always use design token names in Tailwind classes
    - If a design token does not exist, prompt the user if they want to add it to the @theme.css (`src/styles/theme.css`)
- When trying to get a high level understanding of the design, you can use #get_image to get image representation of the design to contextualize what is selected in Figma
- Whenever you want more information about the specific UI elements that are selected, use #get_code
- With the get_code, get_code_connect_map, and get_variable_map tools you will receive information about patterns that should already be defined in this repository.
- If patterns dont already exist, you should ask for permission and clarify what about the design isn't already accounted for in this codebase that is present in the design.

When you see `hidden={true}` in Figma data, it indicates that the node should be ignored. This can happen with Figma components frequently, as nodes that can be toggled with a prop need to exist, even when the prop is false.

**Discovery tip**: When implementing Figma designs, check `codeDependencies` first, then browse the actual component files to understand available props and variants.

### Annotations

In the MCP server response from Figma, you will see annotation attributes that provide context. The annotations can be describing behavior for the current node, or its descendants.

```jsx
<div
    data-content-annotations="Cards' button text is dynamic. They should say upgrade or downgrade if there is a current plan and it is better or worse."
    data-interaction-annotations="Card buttons should be disabled if they are the current plan and their text should say 'current plan'. The pill buttons should update the cards to show annual or monthly pricing."
/>
```

The prefix is a category for the annotation and describes the type of annotation. For example, "content" refers to text or image content annotations, and "interaction" refers to user interaction notes.

- Always read these annotations carefully, as they provide important context for implementing the design correctly.

### Naming Conventions

- In Figma designers often use a "State" property to express CSS pseudo-classes except anything related to focus (because focus can apply to e.g. an ). This can often be

## CSS Variables & Design Tokens

- Use semantic color tokens if available (e.g., `bg-on-light-background-blue`) over primitive color tokens (e.g., `bg-blue-500`)
- Always use Tailwind CSS classes, never write custom CSS

## Storybook

- Generate stories for all props of a component
- Reference @storybook.mdc (`.cursor/storybook.mdc`) for general storybook code style and practices
- Use @storybook.template.tsx (`src/components/ui/.cursor/templates/storybook.template.tsx`) as a blueprint

## Next.js

- Do not create example routes to showcase components, only create Storybook stories
